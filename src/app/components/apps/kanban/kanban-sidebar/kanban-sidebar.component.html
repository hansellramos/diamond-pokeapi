<p-sidebar *ngIf="card" #sidebar [(visible)]="parent.sidebarVisible" position="right" [baseZIndex]="10000" styleClass="w-8 md:w-6 lg:w-4" [showCloseIcon]="false">
    <div  class="px-4 py-6 border-bottom-1 surface-border flex align-items-center justify-content-between h-4rem">
        <p-inplace #inplace closable="closable" closeIcon="pi pi-check" styleClass="h-3rem" (onActivate)="focus()">
            <ng-template pTemplate="display">
                <span class="block text-900 font-semibold text-lg mt-4 pl-2" pTooltip="Click to edit">{{card.title ? card.title : 'Untitled'}}</span>
            </ng-template>
            <ng-template pTemplate="content">
                <input #inputEl type="text" [(ngModel)]="card.title" pInputText class="w-20rem h-3rem text-900 text-lg" (keydown.enter)="inplace.deactivate()">
            </ng-template>
        </p-inplace>
        <div class="relative">
            <button pButton pRipple type="button" icon="pi pi-cog" class="p-button-rounded p-button-text p-button-secondary" (click)="op.toggle($event)"></button>
            <button pButton pRipple type="button" icon="pi pi-times" class="p-button-rounded p-button-text p-button-secondary" (click)="close()" pTooltip="Card actions" tooltipPosition="left"></button>
            <p-overlayPanel #op>
                <ng-template pTemplate>
                    <div class="flex flex-column gap-2 w-15rem">
                        <span class="text-900 font-semibold block w-full border-bottom-1 surface-border pb-3 mb-2">Move to...</span>
                        <span class="text-700 block font-semibold p-2 cursor-pointer hover:surface-ground" *ngFor="let list of listNames" (click)="onMove(list.listId)" style="border-radius:6px;">{{list.title}}</span>
                    </div>
                </ng-template>
            </p-overlayPanel>
        </div>
    </div>
    <div class="grid grid-nogutter gap-5 pt-5 flex-wrap" style="height:82vh; overflow-y: auto;">
        <div class="col-12 field px-5">
            <label for="start" class="block text-900 font-semibold">Description</label>
            <textarea id="description" type="text" pInputTextarea [rows]="5" [(ngModel)]="card.description" style="resize: none" class="w-full"></textarea>
        </div>
        <div class="col-12 px-5 flex gap-5">
            <div class="flex flex-column field w-full">
                <label for="start" class="block text-900 font-semibold">Start Date</label>
                <span class="p-input-icon-left w-full" style="height: 3.5rem;">
                    <i class="pi pi-clock z-1" style="left: 1.5rem;"></i>
                    <p-calendar [appendTo]="sidebar" dateFormat="yy-mm-dd" [showTime]="false" [required]="true" inputId="start" inputStyleClass="w-full pl-7 text-900 font-semibold" styleClass="w-full" [inputStyle]="{'height':'3.5rem'}" [(ngModel)]="card.startDate"></p-calendar>
                </span>
            </div>
            <div class="flex flex-column field w-full">
                <label for="due" class="block text-900 font-semibold">Due Date</label>
                <span class="p-input-icon-left w-full" style="height: 3.5rem;">
                    <i class="pi pi-clock z-1" style="left: 1.5rem;"></i>
                    <p-calendar [appendTo]="sidebar" dateFormat="yy-mm-dd"  [showTime]="false" [required]="true" inputId="due" inputStyleClass="w-full pl-7 text-900 font-semibold" styleClass="w-full" [inputStyle]="{'height':'3.5rem'}" [(ngModel)]="card.dueDate"></p-calendar>
                </span>
            </div>
        </div>

        <div class="col-12 flex flex-column field px-5">
            <div class="flex justify-content-between mb-3">
                <span class="text-900 font-semibold">Progress</span>
                <span class="text-900 font-semibold">{{card.progress}}%</span>
            </div>
            <p-progressBar [value]="card.progress" [showValue]="false"></p-progressBar>
        </div>
        <div class="col-12 flex flex-column field px-5">
            <label for="assignees" class="block text-900 font-semibold mb-3">Assignees</label>
            <p-autoComplete [appendTo]="sidebar" [(ngModel)]="card.assignees" [suggestions]="filteredAssignees" (completeMethod)="filterAssignees($event)" field="name" [multiple]="true" [showEmptyMessage]="true" emptyMessage="No results found" placeholder="Choose assignees" [inputStyle]="{'height': '2.5rem'}">
                <ng-template let-assignee pTemplate="selectedItem">
                    <div class="flex align-items-center gap-3" style="border-radius: 6px;">
                        <img src="assets/demo/images/avatar/{{assignee.image}}" [alt]="assignee.name" class="h-2rem w-2rem border-2 border-circle surface-border mr-2">
                        <span class="text-900 font-semibold">{{assignee.name}}</span>
                    </div>
                </ng-template>
                <ng-template let-assignee pTemplate="item">
                    <div class="flex align-items-center" style="border-radius: 6px;">
                        <img src="assets/demo/images/avatar/{{assignee.image}}" [alt]="assignee.name" class="h-2rem w-2rem border-2 border-circle surface-border mr-2">
                        <span class="text-900 font-semibold">{{assignee.name}}</span>
                    </div>
                </ng-template>
            </p-autoComplete>
        </div>

        <div  class="col-12 flex flex-column row-gap-4 px-5 mb-6">
            <span class="block text-900 font-semibold">Comments</span>
            <div class="flex align-items-center">
                <p-avatar icon="pi pi-user" class="mr-3" shape="circle" size="large"></p-avatar>
                <textarea type="text" pInputTextarea [(ngModel)]="comment" style="resize: none" class="w-full" placeholder="Write a comment..." (keydown.enter)="onComment($event)"></textarea>
            </div>
            <div *ngFor="let comment of card.comments" class="flex align-items-center" style="border-radius: 6px;">
                <p-avatar *ngIf="comment.image" image="assets/demo/images/avatar/{{comment.image}}" class="mb-4" shape="circle" size="large"></p-avatar>
                <p-avatar *ngIf="!comment.image" icon="pi pi-user" class="mb-4" shape="circle" size="large"></p-avatar>
                <div class="ml-3 w-full">
                    <div class="flex justify-content-between mb-2">
                        <span class="block text-900 font-semibold">{{comment.name}}</span>
                        <span class="block text-700 font-semibold">1 Jun 17:58 pm</span>
                    </div>
                    <span class="block text-900 font-semibold border-1 surface-ground surface-border p-2" style="border-radius: 6px; word-break: break-all;">{{comment.text}}</span>
                </div>
            </div>
        </div>

    </div>
    <div class="flex w-full justify-content-end border-top-1 surface-border pt-5 px-5 mt-auto gap-3">
        <button pButton pRipple type="button" icon="pi pi-paperclip" class="p-button-outlined p-button-secondary surface-border text-900 w-3rem h-3rem"></button>
        <button pButton pRipple type="button" icon="pi pi-trash" class="p-button-outlined p-button-secondary surface-border text-900 w-3rem h-3rem" (click)="onDelete()"></button>
        <button pButton pRipple type="button" icon="pi pi-check" label="Save" class="p-button-primary h-3rem" (click)="onSave()"></button>
    </div>
</p-sidebar>